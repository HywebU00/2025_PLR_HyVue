import{m as ye,V as ne}from"./VTextField.1dc90110.js";import{p as O,x as J,D as X,n as o,L as E,G as M,s as W,c as b,r as j,H as Ve,J as we,aD as ke,C as ae,g as Se,A as Ce,F as Pe,k as $,o as Ie,a2 as xe,Y as be,W as Re,a9 as De,aB as Te,E as oe,q as Be,ag as ue,a5 as ie,X as Le}from"./index.0fed8dcb.js";import{j as Ae}from"./VInput.02436975.js";import{f as Fe}from"./forwardRefs.7b10ae4c.js";import{m as _e,u as Me,V as Ee,b as se}from"./VList.fb3a9912.js";import{m as ve,u as Q,s as Oe,A as He,L as Ue,j as re,V as Ke}from"./index.c23348a7.js";import{g as ze,a as qe,V as Ne}from"./VMenu.4a295a77.js";import{u as me}from"./VBtn.8afb6780.js";import{a as $e}from"./VCheckbox.201f7567.js";import{a as je}from"./VChip.99bd7cb8.js";const We=O({renderless:Boolean,...ve()},"VVirtualScrollItem"),Ye=J()({name:"VVirtualScrollItem",inheritAttrs:!1,props:We(),emits:{"update:height":e=>!0},setup(e,f){let{attrs:l,emit:h,slots:d}=f;const{resizeRef:m,contentRect:p}=me(void 0,"border");X(()=>{var t;return(t=p.value)==null?void 0:t.height},t=>{t!=null&&h("update:height",t)}),Q(()=>{var t,a;return e.renderless?o(E,null,[(t=d.default)==null?void 0:t.call(d,{itemRef:m})]):o("div",M({ref:m,class:["v-virtual-scroll__item",e.class],style:e.style},l),[(a=d.default)==null?void 0:a.call(d)])})}}),ce=-1,de=1,Ge=O({itemHeight:{type:[Number,String],default:48}},"virtual");function Je(e,f,l){const h=W(0),d=W(e.itemHeight),m=b({get:()=>{var s;return parseInt((s=d.value)!=null?s:0,10)},set(s){d.value=s}}),p=j(),{resizeRef:t,contentRect:a}=me();Ve(()=>{t.value=p.value});const D=we(),C=new Map;let u=Array.from({length:f.value.length});const i=b(()=>{var r;const s=(!a.value||p.value===document.documentElement?D.height.value:a.value.height)-((r=l==null?void 0:l.value)!=null?r:0);return Math.ceil(s/m.value*1.7+1)});function g(s,r){m.value=Math.max(m.value,r),u[s]=r,C.set(f.value[s],r)}function P(s){return u.slice(0,s).reduce((r,S)=>r+(S||m.value),0)}function I(s){const r=f.value.length;let S=0,x=0;for(;x<s&&S<r;)x+=u[S++]||m.value;return S-1}let A=0;function H(){if(!p.value||!a.value)return;const s=a.value.height-56,r=p.value.scrollTop,S=r<A?ce:de,x=I(r+s/2),U=Math.round(i.value/3),K=x-U,z=h.value+U*2-1;S===ce&&x<=z?h.value=ae(K,0,f.value.length):S===de&&x>=z&&(h.value=ae(K,0,f.value.length-i.value)),A=r}function F(s){if(!p.value)return;const r=P(s);p.value.scrollTop=r}const _=b(()=>Math.min(f.value.length,h.value+i.value)),T=b(()=>f.value.slice(h.value,_.value).map((s,r)=>({raw:s,index:r+h.value}))),Y=b(()=>P(h.value)),G=b(()=>P(f.value.length)-P(_.value));return X(()=>f.value.length,()=>{u=ke(f.value.length).map(()=>m.value),C.forEach((s,r)=>{const S=f.value.indexOf(r);S===-1?C.delete(r):u[S]=s})}),{containerRef:p,computedItems:T,itemHeight:m,paddingTop:Y,paddingBottom:G,scrollToIndex:F,handleScroll:H,handleItemResize:g}}const Xe=O({items:{type:Array,default:()=>[]},renderless:Boolean,...Ge(),...ve(),...Oe()},"VVirtualScroll"),Qe=J()({name:"VVirtualScroll",props:Xe(),setup(e,f){let{slots:l}=f;const h=Se("VVirtualScroll"),{dimensionStyles:d}=He(e),{containerRef:m,handleScroll:p,handleItemResize:t,scrollToIndex:a,paddingTop:D,paddingBottom:C,computedItems:u}=Je(e,Ce(e,"items"));return Pe(()=>e.renderless,()=>{Ie(()=>{var i;m.value=ze(h.vnode.el,!0),(i=m.value)==null||i.addEventListener("scroll",p)}),xe(()=>{var i;(i=m.value)==null||i.removeEventListener("scroll",p)})}),Q(()=>{const i=u.value.map(g=>o(Ye,{key:g.index,renderless:e.renderless,"onUpdate:height":P=>t(g.index,P)},{default:P=>{var I;return(I=l.default)==null?void 0:I.call(l,{item:g.raw,index:g.index,...P})}}));return e.renderless?o(E,null,[o("div",{class:"v-virtual-scroll__spacer",style:{paddingTop:$(D.value)}},null),i,o("div",{class:"v-virtual-scroll__spacer",style:{paddingBottom:$(C.value)}},null)]):o("div",{ref:m,class:["v-virtual-scroll",e.class],onScroll:p,style:[d.value,e.style]},[o("div",{class:"v-virtual-scroll__container",style:{paddingTop:$(D.value),paddingBottom:$(C.value)}},[i])])}),{scrollToIndex:a}}});function Ze(e,f){const l=W(!1);let h;function d(t){cancelAnimationFrame(h),l.value=!0,h=requestAnimationFrame(()=>{h=requestAnimationFrame(()=>{l.value=!1})})}async function m(){await new Promise(t=>requestAnimationFrame(t)),await new Promise(t=>requestAnimationFrame(t)),await new Promise(t=>requestAnimationFrame(t)),await new Promise(t=>{if(l.value){const a=X(l,()=>{a(),t()})}else t()})}async function p(t){var C,u;if(t.key==="Tab"&&((C=f.value)==null||C.focus()),!["PageDown","PageUp","Home","End"].includes(t.key))return;const a=(u=e.value)==null?void 0:u.$el;if(!a)return;(t.key==="Home"||t.key==="End")&&a.scrollTo({top:t.key==="Home"?0:a.scrollHeight,behavior:"smooth"}),await m();const D=a.querySelectorAll(":scope > :not(.v-virtual-scroll__spacer)");if(t.key==="PageDown"||t.key==="Home"){const i=a.getBoundingClientRect().top;for(const g of D)if(g.getBoundingClientRect().top>=i){g.focus();break}}else{const i=a.getBoundingClientRect().bottom;for(const g of[...D].reverse())if(g.getBoundingClientRect().bottom<=i){g.focus();break}}}return{onListScroll:d,onListKeydown:p}}const el=O({chips:Boolean,closableChips:Boolean,eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,menu:Boolean,menuIcon:{type:be,default:"$dropdown"},menuProps:{type:Object},multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,valueComparator:{type:Function,default:Re},itemColor:String,..._e({itemChildren:!1})},"Select"),ll=O({...el(),...De(ye({modelValue:null}),["validationValue","dirty","appendInnerIcon"]),...Ue({transition:{component:qe}})},"VSelect"),vl=J()({name:"VSelect",props:ll(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,f){let{slots:l}=f;const{t:h}=Te(),d=j(),m=j(),p=oe(e,"menu"),t=b({get:()=>p.value,set:n=>{var c;p.value&&!n&&((c=m.value)==null?void 0:c.\u03A8openChildren)||(p.value=n)}}),{items:a,transformIn:D,transformOut:C}=Me(e),u=oe(e,"modelValue",[],n=>D(n===null?[null]:Le(n)),n=>{var y;const c=C(n);return e.multiple?c:(y=c[0])!=null?y:null}),i=Ae(),g=b(()=>u.value.map(n=>a.value.find(c=>{const y=ue(c.raw,e.itemValue),B=ue(n.raw,e.itemValue);return y===void 0||B===void 0?!1:e.returnObject?e.valueComparator(y,B):e.valueComparator(c.value,n.value)})||n)),P=b(()=>g.value.map(n=>n.props.value)),I=W(!1);let A="",H;const F=b(()=>e.hideSelected?a.value.filter(n=>!g.value.some(c=>c===n)):a.value),_=b(()=>e.hideNoData&&!a.value.length||e.readonly||(i==null?void 0:i.isReadonly.value)),T=j(),{onListScroll:Y,onListKeydown:G}=Ze(T,d);function s(n){e.openOnClear&&(t.value=!0)}function r(){_.value||(t.value=!t.value)}function S(n){var v,k;if(!n.key||e.readonly||(i==null?void 0:i.isReadonly.value))return;["Enter"," ","ArrowDown","ArrowUp","Home","End"].includes(n.key)&&n.preventDefault(),["Enter","ArrowDown"," "].includes(n.key)&&(t.value=!0),["Escape","Tab"].includes(n.key)&&(t.value=!1),n.key==="Home"?(v=T.value)==null||v.focus("first"):n.key==="End"&&((k=T.value)==null||k.focus("last"));const c=1e3;function y(V){const R=V.key.length===1,L=!V.ctrlKey&&!V.metaKey&&!V.altKey;return R&&L}if(e.multiple||!y(n))return;const B=performance.now();B-H>c&&(A=""),A+=n.key.toLowerCase(),H=B;const q=a.value.find(V=>V.title.toLowerCase().startsWith(A));q!==void 0&&(u.value=[q])}function x(n){if(e.multiple){const c=P.value.findIndex(y=>e.valueComparator(y,n.value));if(c===-1)u.value=[...u.value,n];else{const y=[...u.value];y.splice(c,1),u.value=y}}else u.value=[n],t.value=!1}function U(n){var c;(c=T.value)!=null&&c.$el.contains(n.relatedTarget)||(t.value=!1)}function K(){var n;I.value&&((n=d.value)==null||n.focus())}function z(n){I.value=!0}function fe(n){if(n==null)u.value=[];else if(ie(d.value,":autofill")||ie(d.value,":-webkit-autofill")){const c=a.value.find(y=>y.title===n);c&&x(c)}else d.value&&(d.value.value="")}return Q(()=>{const n=!!(e.chips||l.chip),c=!!(!e.hideNoData||F.value.length||l["prepend-item"]||l["append-item"]||l["no-data"]),y=u.value.length>0,[B]=ne.filterProps(e),q=y||!I.value&&e.label&&!e.persistentPlaceholder?void 0:e.placeholder;return o(ne,M({ref:d},B,{modelValue:u.value.map(v=>v.props.value).join(", "),"onUpdate:modelValue":fe,focused:I.value,"onUpdate:focused":v=>I.value=v,validationValue:u.externalValue,dirty:y,class:["v-select",{"v-select--active-menu":t.value,"v-select--chips":!!e.chips,[`v-select--${e.multiple?"multiple":"single"}`]:!0,"v-select--selected":u.value.length,"v-select--selection-slot":!!l.selection},e.class],style:e.style,inputmode:"none",placeholder:q,"onClick:clear":s,"onMousedown:control":r,onBlur:U,onKeydown:S}),{...l,default:()=>o(E,null,[o(Ne,M({ref:m,modelValue:t.value,"onUpdate:modelValue":v=>t.value=v,activator:"parent",contentClass:"v-select__content",disabled:_.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:K},e.menuProps),{default:()=>{var v;return[c&&o(Ee,{ref:T,selected:P.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:k=>k.preventDefault(),onKeydown:G,onFocusin:z,onScrollPassive:Y,tabindex:"-1",color:(v=e.itemColor)!=null?v:e.color},{default:()=>{var k,V,R,L;return[(k=l["prepend-item"])==null?void 0:k.call(l),!F.value.length&&!e.hideNoData&&((R=(V=l["no-data"])==null?void 0:V.call(l))!=null?R:o(se,{title:h(e.noDataText)},null)),o(Qe,{renderless:!0,items:F.value},{default:N=>{var le,te;let{item:w,index:Z,itemRef:pe}=N;const ee=M(w.props,{ref:pe,key:Z,onClick:()=>x(w)});return(te=(le=l.item)==null?void 0:le.call(l,{item:w,index:Z,props:ee}))!=null?te:o(se,ee,{prepend:he=>{let{isSelected:ge}=he;return o(E,null,[e.multiple&&!e.hideSelected?o($e,{key:w.value,modelValue:ge,ripple:!1,tabindex:"-1"},null):void 0,w.props.prependIcon&&o(re,{icon:w.props.prependIcon},null)])}})}}),(L=l["append-item"])==null?void 0:L.call(l)]}})]}}),g.value.map((v,k)=>{var L,N;function V(w){w.stopPropagation(),w.preventDefault(),x(v)}const R={"onClick:close":V,onMousedown(w){w.preventDefault(),w.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0};return o("div",{key:v.value,class:"v-select__selection"},[n?l.chip?o(Ke,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:v.title}}},{default:()=>{var w;return[(w=l.chip)==null?void 0:w.call(l,{item:v,index:k,props:R})]}}):o(je,M({key:"chip",closable:e.closableChips,size:"small",text:v.title},R),null):(N=(L=l.selection)==null?void 0:L.call(l,{item:v,index:k}))!=null?N:o("span",{class:"v-select__selection-text"},[v.title,e.multiple&&k<g.value.length-1&&o("span",{class:"v-select__selection-comma"},[Be(",")])])])})]),"append-inner":function(){var R;for(var v=arguments.length,k=new Array(v),V=0;V<v;V++)k[V]=arguments[V];return o(E,null,[(R=l["append-inner"])==null?void 0:R.call(l,...k),e.menuIcon?o(re,{class:"v-select__menu-icon",icon:e.menuIcon},null):void 0])}})}),Fe({isFocused:I,menu:t,select:x},d)}});export{vl as V};
